



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="ApiMeter User Documentation">
      
      
      
        <meta name="author" content="debugtalk">
      
      
        <meta name="lang:clipboard.copy" content="å¤åˆ¶">
      
        <meta name="lang:clipboard.copied" content="å·²å¤åˆ¶">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.result.one" content="æ‰¾åˆ° 1 ä¸ªç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.result.other" content="# ä¸ªç¬¦åˆæ¡ä»¶çš„ç»“æœ">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-3.3.0">
    
    
      
        <title>è‡ªå®šä¹‰å‡½æ•°é«˜çº§ç”¨æ³• - ApiMeter Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.962652e9.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-114587036-2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-114587036-2")</script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        è·³è½¬è‡³
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="ApiMeter Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon">î Œ</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                ApiMeter Docs
              </span>
              <span class="md-header-nav__topic">
                è‡ªå®šä¹‰å‡½æ•°é«˜çº§ç”¨æ³•
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            é”®å…¥ä»¥å¼€å§‹æœç´¢
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://git.umlife.net/utils/apimeter" title="å‰å¾€ Github ä»“åº“" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      ApiMeter
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="ApiMeter Docs" class="md-nav__button md-logo">
      
        <i class="md-icon">î Œ</i>
      
    </a>
    ApiMeter Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://git.umlife.net/utils/apimeter" title="å‰å¾€ Github ä»“åº“" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      ApiMeter
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="ä»‹ç»" class="md-nav__link">
      ä»‹ç»
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Installation/" title="å®‰è£…è¯´æ˜" class="md-nav__link">
      å®‰è£…è¯´æ˜
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      åŸºç¡€æ¦‚å¿µ
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        åŸºç¡€æ¦‚å¿µ
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../concept/nominal/" title="åè¯è§£é‡Š" class="md-nav__link">
      åè¯è§£é‡Š
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      æµ‹è¯•å‡†å¤‡
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        æµ‹è¯•å‡†å¤‡
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/record/" title="å½•åˆ¶ç”Ÿæˆç”¨ä¾‹" class="md-nav__link">
      å½•åˆ¶ç”Ÿæˆç”¨ä¾‹
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/project-structure/" title="é¡¹ç›®æ–‡ä»¶ç»„ç»‡" class="md-nav__link">
      é¡¹ç›®æ–‡ä»¶ç»„ç»‡
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/testcase-structure/" title="æµ‹è¯•ç”¨ä¾‹ç»„ç»‡" class="md-nav__link">
      æµ‹è¯•ç”¨ä¾‹ç»„ç»‡
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/request-hook/" title="hookæœºåˆ¶" class="md-nav__link">
      hookæœºåˆ¶
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/dot-env/" title="ç¯å¢ƒå˜é‡" class="md-nav__link">
      ç¯å¢ƒå˜é‡
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/testcase-layer/" title="æµ‹è¯•ç”¨ä¾‹åˆ†å±‚" class="md-nav__link">
      æµ‹è¯•ç”¨ä¾‹åˆ†å±‚
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/parameters/" title="å‚æ•°åŒ–æ•°æ®é©±åŠ¨" class="md-nav__link">
      å‚æ•°åŒ–æ•°æ®é©±åŠ¨
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/validate/" title="æ ¡éªŒå™¨ç”¨æ³•" class="md-nav__link">
      æ ¡éªŒå™¨ç”¨æ³•
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/script/" title="è‡ªå®šä¹‰è„šæœ¬æ ¡éªŒ" class="md-nav__link">
      è‡ªå®šä¹‰è„šæœ¬æ ¡éªŒ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/pretty/" title="ç”¨ä¾‹æ ¼å¼åŒ–" class="md-nav__link">
      ç”¨ä¾‹æ ¼å¼åŒ–
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/yaml-issue/" title="å¸¸è§æ ¼å¼é—®é¢˜" class="md-nav__link">
      å¸¸è§æ ¼å¼é—®é¢˜
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/security/" title="ä¿¡æ¯å®‰å…¨" class="md-nav__link">
      ä¿¡æ¯å®‰å…¨
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../prepare/upload-case/" title="æ–‡ä»¶ä¸Šä¼ åœºæ™¯" class="md-nav__link">
      æ–‡ä»¶ä¸Šä¼ åœºæ™¯
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      æµ‹è¯•æ‰§è¡Œ
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        æµ‹è¯•æ‰§è¡Œ
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../run-tests/cli/" title="è¿è¡Œæµ‹è¯•(CLI)" class="md-nav__link">
      è¿è¡Œæµ‹è¯•(CLI)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../run-tests/report/" title="æµ‹è¯•æŠ¥å‘Š" class="md-nav__link">
      æµ‹è¯•æŠ¥å‘Š
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../run-tests/load-test/" title="æ€§èƒ½æµ‹è¯•" class="md-nav__link">
      æ€§èƒ½æµ‹è¯•
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      å¼€å‘æ‰©å±•
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        å¼€å‘æ‰©å±•
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/architecture/" title="ä»£ç æ¡†æ¶" class="md-nav__link">
      ä»£ç æ¡†æ¶
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/dev-api/" title="å¼€å‘æ‰©å±•" class="md-nav__link">
      å¼€å‘æ‰©å±•
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../FAQ/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      å®è·µæ¡ˆä¾‹
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        å®è·µæ¡ˆä¾‹
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/quickstart-case/" title="å¿«é€Ÿä¸Šæ‰‹æ¡ˆä¾‹" class="md-nav__link">
      å¿«é€Ÿä¸Šæ‰‹æ¡ˆä¾‹
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/testerhome-login/" title="TesterHome ç™»å½•" class="md-nav__link">
      TesterHome ç™»å½•
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/demo-klook/" title="klook" class="md-nav__link">
      klook
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../related-docs/" title="ç›¸å…³èµ„æ–™" class="md-nav__link">
      ç›¸å…³èµ„æ–™
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../CHANGELOG/" title="CHANGELOG" class="md-nav__link">
      CHANGELOG
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">ç›®å½•</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" title="ğŸ“š ç›®å½•" class="md-nav__link">
    ğŸ“š ç›®å½•
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§å‚æ•°è§£æï¼Ÿ" class="md-nav__link">
    ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§å‚æ•°è§£æï¼Ÿ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" title="å®é™…åœºæ™¯çš„å¤æ‚æ€§" class="md-nav__link">
    å®é™…åœºæ™¯çš„å¤æ‚æ€§
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" title="1. åŸºç¡€å›é¡¾" class="md-nav__link">
    1. åŸºç¡€å›é¡¾
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" title="1.1 ç®€å•å‚æ•°ä¼ é€’" class="md-nav__link">
    1.1 ç®€å•å‚æ•°ä¼ é€’
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" title="1.2 å¤šä¸ªå‚æ•°ä¼ é€’" class="md-nav__link">
    1.2 å¤šä¸ªå‚æ•°ä¼ é€’
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" title="2. é“¾å¼å–å€¼" class="md-nav__link">
    2. é“¾å¼å–å€¼
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" title="2.1 å…¨å±€å˜é‡é“¾å¼å–å€¼" class="md-nav__link">
    2.1 å…¨å±€å˜é‡é“¾å¼å–å€¼
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" title="2.2 è‡ªå®šä¹‰å˜é‡é“¾å¼å–å€¼" class="md-nav__link">
    2.2 è‡ªå®šä¹‰å˜é‡é“¾å¼å–å€¼
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" title="2.3 æ•°ç»„ç´¢å¼•è®¿é—®" class="md-nav__link">
    2.3 æ•°ç»„ç´¢å¼•è®¿é—®
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" title="3. åˆ—è¡¨å‚æ•°è§£æ" class="md-nav__link">
    3. åˆ—è¡¨å‚æ•°è§£æ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" title="3.1 åŸºæœ¬è¯­æ³•" class="md-nav__link">
    3.1 åŸºæœ¬è¯­æ³•
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" title="3.2 ä½¿ç”¨åœºæ™¯ï¼šç­¾åç”Ÿæˆ" class="md-nav__link">
    3.2 ä½¿ç”¨åœºæ™¯ï¼šç­¾åç”Ÿæˆ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" title="3.3 ä½¿ç”¨åœºæ™¯ï¼šæ‰¹é‡æ ¡éªŒ" class="md-nav__link">
    3.3 ä½¿ç”¨åœºæ™¯ï¼šæ‰¹é‡æ ¡éªŒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" title="3.4 åˆ—è¡¨å‚æ•° + å˜é‡å¼•ç”¨" class="md-nav__link">
    3.4 åˆ—è¡¨å‚æ•° + å˜é‡å¼•ç”¨
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" title="4. å­—å…¸å¯¹è±¡å‚æ•°è§£æ" class="md-nav__link">
    4. å­—å…¸å¯¹è±¡å‚æ•°è§£æ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" title="4.1 åŸºæœ¬è¯­æ³•" class="md-nav__link">
    4.1 åŸºæœ¬è¯­æ³•
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" title="4.2 ä½¿ç”¨åœºæ™¯ï¼šå¤æ‚ç­¾åé…ç½®" class="md-nav__link">
    4.2 ä½¿ç”¨åœºæ™¯ï¼šå¤æ‚ç­¾åé…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" title="4.3 ä½¿ç”¨åœºæ™¯ï¼šé…ç½®å¯¹è±¡ä¼ é€’" class="md-nav__link">
    4.3 ä½¿ç”¨åœºæ™¯ï¼šé…ç½®å¯¹è±¡ä¼ é€’
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" title="5. å¤æ‚åµŒå¥—å¯¹è±¡å‚æ•°" class="md-nav__link">
    5. å¤æ‚åµŒå¥—å¯¹è±¡å‚æ•°
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" title="5.1 ä½¿ç”¨åœºæ™¯ï¼šåµŒå¥—åˆ—è¡¨æ‰¹é‡æ ¡éªŒ" class="md-nav__link">
    5.1 ä½¿ç”¨åœºæ™¯ï¼šåµŒå¥—åˆ—è¡¨æ‰¹é‡æ ¡éªŒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" title="5.2 ä½¿ç”¨åœºæ™¯ï¼šå¤šçº§é…ç½®å¯¹è±¡" class="md-nav__link">
    5.2 ä½¿ç”¨åœºæ™¯ï¼šå¤šçº§é…ç½®å¯¹è±¡
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" title="6. é€šé…ç¬¦æ‰¹é‡æ ¡éªŒ" class="md-nav__link">
    6. é€šé…ç¬¦æ‰¹é‡æ ¡éªŒ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" title="6.1 é€šé…ç¬¦ * è¯­æ³•" class="md-nav__link">
    6.1 é€šé…ç¬¦ * è¯­æ³•
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62" title="6.2 å•å±‚é€šé…ç¬¦" class="md-nav__link">
    6.2 å•å±‚é€šé…ç¬¦
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63" title="6.3 å¤šå±‚é€šé…ç¬¦" class="md-nav__link">
    6.3 å¤šå±‚é€šé…ç¬¦
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64" title="6.4 é€šé…ç¬¦ + é“¾å¼å–å€¼" class="md-nav__link">
    6.4 é€šé…ç¬¦ + é“¾å¼å–å€¼
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" title="7. æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ" class="md-nav__link">
    7. æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71" title="7.1 æ­£åˆ™è¡¨è¾¾å¼è¯­æ³• ~=" class="md-nav__link">
    7.1 æ­£åˆ™è¡¨è¾¾å¼è¯­æ³• ~=
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-url" title="7.2 ä½¿ç”¨åœºæ™¯ï¼šURL æ ¼å¼æ ¡éªŒ" class="md-nav__link">
    7.2 ä½¿ç”¨åœºæ™¯ï¼šURL æ ¼å¼æ ¡éªŒ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" title="8. ç±»å‹æ ¡éªŒ" class="md-nav__link">
    8. ç±»å‹æ ¡éªŒ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81" title="8.1 ç±»å‹æ ¡éªŒè¯­æ³• @=" class="md-nav__link">
    8.1 ç±»å‹æ ¡éªŒè¯­æ³• @=
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" title="8.2 ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®ç»“æ„æ ¡éªŒ" class="md-nav__link">
    8.2 ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®ç»“æ„æ ¡éªŒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83" title="8.3 åŒ…å«æ ¡éªŒè¯­æ³• =*" class="md-nav__link">
    8.3 åŒ…å«æ ¡éªŒè¯­æ³• =*
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9" title="9. ç»¼åˆå®æˆ˜æ¡ˆä¾‹" class="md-nav__link">
    9. ç»¼åˆå®æˆ˜æ¡ˆä¾‹
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-api" title="æ¡ˆä¾‹ 1ï¼šç”µå•† API å®Œæ•´æ ¡éªŒ" class="md-nav__link">
    æ¡ˆä¾‹ 1ï¼šç”µå•† API å®Œæ•´æ ¡éªŒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" title="æ¡ˆä¾‹ 2ï¼šç”¨æˆ·ä¿¡æ¯å¤æ‚æ ¡éªŒ" class="md-nav__link">
    æ¡ˆä¾‹ 2ï¼šç”¨æˆ·ä¿¡æ¯å¤æ‚æ ¡éªŒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" title="æ¡ˆä¾‹ 3ï¼šå¤šç¯å¢ƒé…ç½®ç­¾å" class="md-nav__link">
    æ¡ˆä¾‹ 3ï¼šå¤šç¯å¢ƒé…ç½®ç­¾å
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10" title="10. æœ€ä½³å®è·µ" class="md-nav__link">
    10. æœ€ä½³å®è·µ
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101" title="10.1 å‚æ•°å‘½åè§„èŒƒ" class="md-nav__link">
    10.1 å‚æ•°å‘½åè§„èŒƒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102" title="10.2 å‡½æ•°èŒè´£å•ä¸€" class="md-nav__link">
    10.2 å‡½æ•°èŒè´£å•ä¸€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103" title="10.3 æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯" class="md-nav__link">
    10.3 æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104" title="10.4 åˆç†ä½¿ç”¨é€šé…ç¬¦" class="md-nav__link">
    10.4 åˆç†ä½¿ç”¨é€šé…ç¬¦
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#105" title="10.5 æ–‡æ¡£æ³¨é‡Š" class="md-nav__link">
    10.5 æ–‡æ¡£æ³¨é‡Š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#106" title="10.6 æ€§èƒ½è€ƒè™‘" class="md-nav__link">
    10.6 æ€§èƒ½è€ƒè™‘
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" title="ğŸ“ æ€»ç»“" class="md-nav__link">
    ğŸ“ æ€»ç»“
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                
                <h1 id="_1">è‡ªå®šä¹‰å‡½æ•°é«˜çº§ç”¨æ³•<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» ApiMeter ä¸­è‡ªå®šä¹‰å‡½æ•°çš„é«˜çº§å‚æ•°ä¼ é€’åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ—è¡¨å‚æ•°ã€å­—å…¸å‚æ•°ã€åµŒå¥—å¯¹è±¡å‚æ•°ä»¥åŠé€šé…ç¬¦æ‰¹é‡æ ¡éªŒç­‰å¼ºå¤§ç‰¹æ€§ã€‚</p>
<h2 id="_2">ğŸ“š ç›®å½•<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§å‚æ•°è§£æ">ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§å‚æ•°è§£æï¼Ÿ</a></li>
<li><a href="#1-åŸºç¡€å›é¡¾">1. åŸºç¡€å›é¡¾</a></li>
<li><a href="#2-é“¾å¼å–å€¼">2. é“¾å¼å–å€¼</a></li>
<li><a href="#3-åˆ—è¡¨å‚æ•°è§£æ">3. åˆ—è¡¨å‚æ•°è§£æ</a></li>
<li><a href="#4-å­—å…¸å¯¹è±¡å‚æ•°è§£æ">4. å­—å…¸å¯¹è±¡å‚æ•°è§£æ</a></li>
<li><a href="#5-å¤æ‚åµŒå¥—å¯¹è±¡å‚æ•°">5. å¤æ‚åµŒå¥—å¯¹è±¡å‚æ•°</a></li>
<li><a href="#6-é€šé…ç¬¦æ‰¹é‡æ ¡éªŒ">6. é€šé…ç¬¦æ‰¹é‡æ ¡éªŒ</a></li>
<li><a href="#7-æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ">7. æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ</a></li>
<li><a href="#8-ç±»å‹æ ¡éªŒ">8. ç±»å‹æ ¡éªŒ</a></li>
<li><a href="#9-ç»¼åˆå®æˆ˜æ¡ˆä¾‹">9. ç»¼åˆå®æˆ˜æ¡ˆä¾‹</a></li>
<li><a href="#10-æœ€ä½³å®è·µ">10. æœ€ä½³å®è·µ</a></li>
</ul>
<h2 id="_3">ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§å‚æ•°è§£æï¼Ÿ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">å®é™…åœºæ™¯çš„å¤æ‚æ€§<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>åœ¨å®é™… API æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é‡åˆ°ä»¥ä¸‹å¤æ‚åœºæ™¯ï¼š</p>
<p><strong>åœºæ™¯ 1ï¼šç­¾åç”Ÿæˆ</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># éœ€è¦å°†å¤šä¸ªå‚æ•°ç»„åˆç”Ÿæˆç­¾å</span>
<span class="n">sign</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">device_sn</span> <span class="o">+</span> <span class="n">os_platform</span> <span class="o">+</span> <span class="n">app_version</span> <span class="o">+</span> <span class="n">timestamp</span><span class="p">)</span>
</code></pre></div>

<p><strong>åœºæ™¯ 2ï¼šæ‰¹é‡æ•°æ®æ ¡éªŒ</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;products&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="p">}]}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>éœ€è¦æ ¡éªŒæ‰€æœ‰ sku ä¸­çš„ id å’Œ price å­—æ®µã€‚</p>
<p><strong>åœºæ™¯ 3ï¼šå¤æ‚é…ç½®ä¼ é€’</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># éœ€è¦ä¼ é€’å¤æ‚çš„é…ç½®å¯¹è±¡</span>
<span class="n">validate_data</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="p">{</span>
    <span class="s2">&quot;list_path&quot;</span><span class="p">:</span> <span class="s2">&quot;products&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nested_field&quot;</span><span class="p">:</span> <span class="s2">&quot;sku&quot;</span><span class="p">,</span>
    <span class="s2">&quot;check_fields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;currency&quot;</span><span class="p">]</span>
<span class="p">})</span>
</code></pre></div>

<p>ä¼ ç»Ÿçš„å‚æ•°ä¼ é€’æ–¹å¼æ— æ³•ä¼˜é›…åœ°å¤„ç†è¿™äº›åœºæ™¯ï¼ŒApiMeter çš„é«˜çº§å‚æ•°è§£æåŠŸèƒ½å®Œç¾è§£å†³äº†è¿™äº›é—®é¢˜ã€‚</p>
<h2 id="1">1. åŸºç¡€å›é¡¾<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ç®€å•å‚æ•°ä¼ é€’<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>æœ€åŸºç¡€çš„ç”¨æ³•ï¼Œä¼ é€’å•ä¸ªå‚æ•°ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># debugtalk.py</span>
<span class="nt">def validate_token(token)</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">assert len(token) == 16, f&quot;Token length should be 16, got {len(token)}&quot;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">return True</span>

<span class="c1"># æµ‹è¯•ç”¨ä¾‹</span>
<span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${validate_token(content.token)}</span>
</code></pre></div>

<h3 id="12">1.2 å¤šä¸ªå‚æ•°ä¼ é€’<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>ä¼ é€’å¤šä¸ªç‹¬ç«‹å‚æ•°ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># debugtalk.py</span>
<span class="l l-Scalar l-Scalar-Plain">def get_sign(device_sn, os_platform, app_version)</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">content = f&quot;{device_sn}{os_platform}{app_version}&quot;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">return hashlib.md5(content.encode()).hexdigest()</span>

<span class="c1"># æµ‹è¯•ç”¨ä¾‹</span>
<span class="nt">request</span><span class="p">:</span>
<span class="w">  </span><span class="nt">json</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_sign($device_sn, $os_platform, $app_version)}</span>
</code></pre></div>

<h2 id="2">2. é“¾å¼å–å€¼<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 å…¨å±€å˜é‡é“¾å¼å–å€¼<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p>ç›´æ¥è®¿é—®å“åº”æ•°æ®çš„æ·±å±‚å­—æ®µï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># debugtalk.py</span>
<span class="nt">def validate_user_name(name)</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">assert len(name) &gt; 0, &quot;User name cannot be empty&quot;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">return True</span>

<span class="c1"># æµ‹è¯•ç”¨ä¾‹ - é“¾å¼è®¿é—®</span>
<span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># è®¿é—® content.data.user.profile.name</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${validate_user_name(content.data.user.profile.name)}</span>
</code></pre></div>

<p><strong>å“åº”æ•°æ®ç¤ºä¾‹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;profile&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="22">2.2 è‡ªå®šä¹‰å˜é‡é“¾å¼å–å€¼<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<p>æå–å˜é‡åæ”¯æŒé“¾å¼è®¿é—®ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">extract</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user_info</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">content.data.user</span>

<span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ä½¿ç”¨æå–çš„å˜é‡è¿›è¡Œé“¾å¼è®¿é—®</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${validate_user_name($user_info.profile.name)}</span>
</code></pre></div>

<h3 id="23">2.3 æ•°ç»„ç´¢å¼•è®¿é—®<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># è®¿é—®æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å­—æ®µ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${validate_price(content.products[0].price)}</span>

<span class="w">  </span><span class="c1"># è®¿é—®åµŒå¥—æ•°ç»„</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${validate_sku_id(content.products[0].sku[0].id)}</span>
</code></pre></div>

<h2 id="3">3. åˆ—è¡¨å‚æ•°è§£æ<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 åŸºæœ¬è¯­æ³•<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p>ä½¿ç”¨ä¸­æ‹¬å· <code>[]</code> ä¼ é€’åˆ—è¡¨å‚æ•°ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">${function_name([$param1, $param2, $param3])}</span>
</code></pre></div>

<h3 id="32">3.2 ä½¿ç”¨åœºæ™¯ï¼šç­¾åç”Ÿæˆ<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<p><strong>åœºæ™¯æè¿°</strong>ï¼š
API éœ€è¦å°†å¤šä¸ªå‚æ•°ç»„åˆåç”Ÿæˆç­¾åï¼Œä¼ ç»Ÿæ–¹å¼éœ€è¦é€ä¸ªä¼ é€’å‚æ•°ï¼Œä½¿ç”¨åˆ—è¡¨å‚æ•°å¯ä»¥æ›´ç®€æ´ã€‚</p>
<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s2">&quot;DebugTalk&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_sign_v2</span><span class="p">(</span><span class="n">args_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ä½¿ç”¨åˆ—è¡¨å‚æ•°ç”Ÿæˆç­¾å</span>

<span class="sd">    Args:</span>
<span class="sd">        args_list: å‚æ•°åˆ—è¡¨ï¼Œå¦‚ [&quot;device_001&quot;, &quot;ios&quot;, &quot;2.8.6&quot;]</span>

<span class="sd">    Returns:</span>
<span class="sd">        ç­¾åå­—ç¬¦ä¸²</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_list</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
    <span class="n">sign_key</span> <span class="o">=</span> <span class="n">SECRET_KEY</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">sign_key</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sign</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">config</span><span class="p">:</span>
<span class="w">  </span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="nt">device_sn</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TEST_DEVICE_001&quot;</span>
<span class="w">    </span><span class="nt">os_platform</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ios&quot;</span>
<span class="w">    </span><span class="nt">app_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2.8.6&quot;</span>

<span class="nt">teststeps</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">è·å–è®¿é—®ä»¤ç‰Œ</span>
<span class="w">  </span><span class="nt">request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/api/get-token</span>
<span class="w">    </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POST</span>
<span class="w">    </span><span class="nt">json</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># ä½¿ç”¨åˆ—è¡¨å‚æ•°ä¼ é€’</span>
<span class="w">      </span><span class="nt">sign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_sign_v2([$device_sn, $os_platform, $app_version])}</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assert status_code == 200</span>
</code></pre></div>

<h3 id="33">3.3 ä½¿ç”¨åœºæ™¯ï¼šæ‰¹é‡æ ¡éªŒ<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<p><strong>åœºæ™¯æè¿°</strong>ï¼š
éœ€è¦åŒæ—¶æ ¡éªŒå¤šä¸ªå­—æ®µæ˜¯å¦å­˜åœ¨ã€‚</p>
<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_fields_exist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fields_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    æ‰¹é‡æ£€æŸ¥å­—æ®µæ˜¯å¦å­˜åœ¨</span>

<span class="sd">    Args:</span>
<span class="sd">        data: æ•°æ®å¯¹è±¡</span>
<span class="sd">        fields_list: å­—æ®µåˆ—è¡¨ï¼Œå¦‚ [&quot;id&quot;, &quot;name&quot;, &quot;email&quot;]</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if all fields exist</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_list</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Missing required field: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># æ‰¹é‡æ£€æŸ¥ç”¨æˆ·å¿…å¡«å­—æ®µ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check_fields_exist(content.user, [id, name, email, phone])}</span>

<span class="w">  </span><span class="c1"># æ‰¹é‡æ£€æŸ¥äº§å“å¿…å¡«å­—æ®µ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check_fields_exist(content.product, [id, title, price, stock])}</span>
</code></pre></div>

<h3 id="34">3.4 åˆ—è¡¨å‚æ•° + å˜é‡å¼•ç”¨<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="nt">variables</span><span class="p">:</span>
<span class="w">  </span><span class="nt">required_user_fields</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;email&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">required_product_fields</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;title&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;price&quot;</span><span class="p p-Indicator">]</span>

<span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># å¼•ç”¨å˜é‡åˆ—è¡¨</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check_fields_exist(content.user, $required_user_fields)}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check_fields_exist(content.product, $required_product_fields)}</span>
</code></pre></div>

<h2 id="4">4. å­—å…¸å¯¹è±¡å‚æ•°è§£æ<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 åŸºæœ¬è¯­æ³•<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<p>ä½¿ç”¨èŠ±æ‹¬å· <code>{}</code> ä¼ é€’å­—å…¸å‚æ•°ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">${function_name({key1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1, key2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2})}</span>
</code></pre></div>

<p><strong>æ³¨æ„</strong>ï¼šå­—å…¸å‚æ•°é€šå¸¸éœ€è¦ç”¨å¼•å·åŒ…è£¹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="s">&quot;${function_name({key1:</span><span class="nv"> </span><span class="s">value1,</span><span class="nv"> </span><span class="s">key2:</span><span class="nv"> </span><span class="s">value2})}&quot;</span>
</code></pre></div>

<h3 id="42">4.2 ä½¿ç”¨åœºæ™¯ï¼šå¤æ‚ç­¾åé…ç½®<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<p><strong>åœºæ™¯æè¿°</strong>ï¼š
ç­¾åç®—æ³•éœ€è¦å¤šä¸ªå‚æ•°ï¼Œä½¿ç”¨å­—å…¸å¯ä»¥è®©å‚æ•°æ›´æœ‰è¯­ä¹‰ã€‚</p>
<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s2">&quot;DebugTalk&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_sign_v3</span><span class="p">(</span><span class="n">args_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ä½¿ç”¨å­—å…¸å‚æ•°ç”Ÿæˆç­¾å</span>

<span class="sd">    Args:</span>
<span class="sd">        args_dict: å‚æ•°å­—å…¸ï¼Œå¦‚ {</span>
<span class="sd">            &quot;device_sn&quot;: &quot;xxx&quot;,</span>
<span class="sd">            &quot;os_platform&quot;: &quot;ios&quot;,</span>
<span class="sd">            &quot;app_version&quot;: &quot;2.8.6&quot;</span>
<span class="sd">        }</span>

<span class="sd">    Returns:</span>
<span class="sd">        ç­¾åå­—ç¬¦ä¸²</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
        <span class="n">args_dict</span><span class="p">[</span><span class="s2">&quot;device_sn&quot;</span><span class="p">],</span>
        <span class="n">args_dict</span><span class="p">[</span><span class="s2">&quot;os_platform&quot;</span><span class="p">],</span>
        <span class="n">args_dict</span><span class="p">[</span><span class="s2">&quot;app_version&quot;</span><span class="p">]</span>
    <span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
    <span class="n">sign_key</span> <span class="o">=</span> <span class="n">SECRET_KEY</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">sign_key</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sign</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">request</span><span class="p">:</span>
<span class="w">  </span><span class="nt">json</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># ä½¿ç”¨å­—å…¸å‚æ•°ï¼ˆæ³¨æ„å¤–å±‚å¼•å·ï¼‰</span>
<span class="w">    </span><span class="nt">sign</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${get_sign_v3({</span>
<span class="w">      </span><span class="s">device_sn:</span><span class="nv"> </span><span class="s">$device_sn,</span>
<span class="w">      </span><span class="s">os_platform:</span><span class="nv"> </span><span class="s">$os_platform,</span>
<span class="w">      </span><span class="s">app_version:</span><span class="nv"> </span><span class="s">$app_version</span>
<span class="w">    </span><span class="s">})}&quot;</span>
</code></pre></div>

<h3 id="43">4.3 ä½¿ç”¨åœºæ™¯ï¼šé…ç½®å¯¹è±¡ä¼ é€’<a class="headerlink" href="#43" title="Permanent link">&para;</a></h3>
<p><strong>åœºæ™¯æè¿°</strong>ï¼š
æ•°æ®æ ¡éªŒéœ€è¦å¤æ‚çš„é…ç½®ä¿¡æ¯ã€‚</p>
<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_with_config</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    æ ¹æ®é…ç½®æ ¡éªŒæ•°æ®</span>

<span class="sd">    Args:</span>
<span class="sd">        data: å¾…æ ¡éªŒæ•°æ®</span>
<span class="sd">        config: é…ç½®å¯¹è±¡ï¼Œå¦‚ {</span>
<span class="sd">            &quot;min_length&quot;: 10,</span>
<span class="sd">            &quot;max_length&quot;: 100,</span>
<span class="sd">            &quot;allow_empty&quot;: false</span>
<span class="sd">        }</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if validation passes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">min_len</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;min_length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">max_len</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
    <span class="n">allow_empty</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;allow_empty&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_empty</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Data cannot be empty&quot;</span>

    <span class="k">assert</span> <span class="n">min_len</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_len</span><span class="p">,</span> \
        <span class="sa">f</span><span class="s2">&quot;Data length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> not in range [</span><span class="si">{</span><span class="n">min_len</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">max_len</span><span class="si">}</span><span class="s2">]&quot;</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ä¼ é€’é…ç½®å¯¹è±¡</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;${validate_with_config(content.description,</span><span class="nv"> </span><span class="s">{</span>
<span class="w">      </span><span class="s">min_length:</span><span class="nv"> </span><span class="s">10,</span>
<span class="w">      </span><span class="s">max_length:</span><span class="nv"> </span><span class="s">500,</span>
<span class="w">      </span><span class="s">allow_empty:</span><span class="nv"> </span><span class="s">false</span>
<span class="w">    </span><span class="s">})}&quot;</span>
</code></pre></div>

<h2 id="5">5. å¤æ‚åµŒå¥—å¯¹è±¡å‚æ•°<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ä½¿ç”¨åœºæ™¯ï¼šåµŒå¥—åˆ—è¡¨æ‰¹é‡æ ¡éªŒ<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<p><strong>åœºæ™¯æè¿°</strong>ï¼š
å“åº”æ•°æ®åŒ…å«å¤šå±‚åµŒå¥—ç»“æ„ï¼Œéœ€è¦æ‰¹é‡æ ¡éªŒæ‰€æœ‰åµŒå¥—æ•°æ®çš„ç‰¹å®šå­—æ®µã€‚</p>
<p><strong>å“åº”æ•°æ®ç»“æ„</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;productList&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Product 1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Product 2&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EUR&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EUR&quot;</span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_nested_list_fields</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    æ£€æŸ¥åµŒå¥—åˆ—è¡¨ä¸­çš„å­—æ®µ</span>

<span class="sd">    Args:</span>
<span class="sd">        data: å“åº”æ•°æ®</span>
<span class="sd">        config: é…ç½®å¯¹è±¡ {</span>
<span class="sd">            &quot;list_path&quot;: &quot;productList&quot;,        # å¤–å±‚åˆ—è¡¨è·¯å¾„</span>
<span class="sd">            &quot;nested_field&quot;: &quot;sku&quot;,             # å†…å±‚åˆ—è¡¨å­—æ®µå</span>
<span class="sd">            &quot;check_fields&quot;: [&quot;id&quot;, &quot;amount&quot;]   # éœ€è¦æ£€æŸ¥çš„å­—æ®µ</span>
<span class="sd">        }</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if all validations pass</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">list_path</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;list_path&quot;</span><span class="p">]</span>
    <span class="n">nested_field</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;nested_field&quot;</span><span class="p">]</span>
    <span class="n">check_fields</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;check_fields&quot;</span><span class="p">]</span>

    <span class="c1"># è·å–å¤–å±‚åˆ—è¡¨</span>
    <span class="n">items</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">list_path</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;List &#39;</span><span class="si">{</span><span class="n">list_path</span><span class="si">}</span><span class="s2">&#39; is empty&quot;</span>

    <span class="c1"># éå†å¤–å±‚åˆ—è¡¨</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="c1"># è·å–å†…å±‚åˆ—è¡¨</span>
        <span class="n">nested_items</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nested_field</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;Nested field &#39;</span><span class="si">{</span><span class="n">nested_field</span><span class="si">}</span><span class="s2">&#39; is empty in item </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># éå†å†…å±‚åˆ—è¡¨ï¼Œæ£€æŸ¥å­—æ®µ</span>
        <span class="k">for</span> <span class="n">nested_item</span> <span class="ow">in</span> <span class="n">nested_items</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">check_fields</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">nested_item</span><span class="p">,</span> \
                    <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; not found in nested item&quot;</span>
                <span class="k">assert</span> <span class="n">nested_item</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> \
                    <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; is None&quot;</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># æ£€æŸ¥åµŒå¥—åˆ—è¡¨ä¸­çš„å­—æ®µ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;${check_nested_list_fields(content,</span><span class="nv"> </span><span class="s">{</span>
<span class="w">      </span><span class="s">list_path:</span><span class="nv"> </span><span class="s">productList,</span>
<span class="w">      </span><span class="s">nested_field:</span><span class="nv"> </span><span class="s">sku,</span>
<span class="w">      </span><span class="s">check_fields:</span><span class="nv"> </span><span class="s">[id,</span><span class="nv"> </span><span class="s">amount,</span><span class="nv"> </span><span class="s">currency]</span>
<span class="w">    </span><span class="s">})}&quot;</span>
</code></pre></div>

<h3 id="52">5.2 ä½¿ç”¨åœºæ™¯ï¼šå¤šçº§é…ç½®å¯¹è±¡<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_complex_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">validation_rules</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ä½¿ç”¨å¤æ‚è§„åˆ™éªŒè¯æ•°æ®</span>

<span class="sd">    Args:</span>
<span class="sd">        data: å¾…éªŒè¯æ•°æ®</span>
<span class="sd">        validation_rules: éªŒè¯è§„åˆ™ {</span>
<span class="sd">            &quot;user&quot;: {</span>
<span class="sd">                &quot;required_fields&quot;: [&quot;id&quot;, &quot;name&quot;],</span>
<span class="sd">                &quot;name_min_length&quot;: 2</span>
<span class="sd">            },</span>
<span class="sd">            &quot;product&quot;: {</span>
<span class="sd">                &quot;required_fields&quot;: [&quot;id&quot;, &quot;price&quot;],</span>
<span class="sd">                &quot;price_min&quot;: 0</span>
<span class="sd">            }</span>
<span class="sd">        }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># éªŒè¯ user æ•°æ®</span>
    <span class="k">if</span> <span class="s2">&quot;user&quot;</span> <span class="ow">in</span> <span class="n">validation_rules</span><span class="p">:</span>
        <span class="n">user_rules</span> <span class="o">=</span> <span class="n">validation_rules</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">]</span>
        <span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># æ£€æŸ¥å¿…å¡«å­—æ®µ</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">user_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;required_fields&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="k">assert</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">user_data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;User missing field: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># æ£€æŸ¥åç§°é•¿åº¦</span>
        <span class="k">if</span> <span class="s2">&quot;name_min_length&quot;</span> <span class="ow">in</span> <span class="n">user_rules</span><span class="p">:</span>
            <span class="n">min_len</span> <span class="o">=</span> <span class="n">user_rules</span><span class="p">[</span><span class="s2">&quot;name_min_length&quot;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">min_len</span>

    <span class="c1"># éªŒè¯ product æ•°æ®</span>
    <span class="k">if</span> <span class="s2">&quot;product&quot;</span> <span class="ow">in</span> <span class="n">validation_rules</span><span class="p">:</span>
        <span class="n">product_rules</span> <span class="o">=</span> <span class="n">validation_rules</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span>
        <span class="n">product_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># æ£€æŸ¥å¿…å¡«å­—æ®µ</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">product_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;required_fields&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="k">assert</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">product_data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Product missing field: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># æ£€æŸ¥ä»·æ ¼</span>
        <span class="k">if</span> <span class="s2">&quot;price_min&quot;</span> <span class="ow">in</span> <span class="n">product_rules</span><span class="p">:</span>
            <span class="n">price_min</span> <span class="o">=</span> <span class="n">product_rules</span><span class="p">[</span><span class="s2">&quot;price_min&quot;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">product_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">price_min</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ä¼ é€’å¤šçº§é…ç½®å¯¹è±¡</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;${validate_complex_data(content,</span><span class="nv"> </span><span class="s">{</span>
<span class="w">      </span><span class="s">user:</span><span class="nv"> </span><span class="s">{</span>
<span class="w">        </span><span class="s">required_fields:</span><span class="nv"> </span><span class="s">[id,</span><span class="nv"> </span><span class="s">name,</span><span class="nv"> </span><span class="s">email],</span>
<span class="w">        </span><span class="s">name_min_length:</span><span class="nv"> </span><span class="s">2</span>
<span class="w">      </span><span class="s">},</span>
<span class="w">      </span><span class="s">product:</span><span class="nv"> </span><span class="s">{</span>
<span class="w">        </span><span class="s">required_fields:</span><span class="nv"> </span><span class="s">[id,</span><span class="nv"> </span><span class="s">price,</span><span class="nv"> </span><span class="s">stock],</span>
<span class="w">        </span><span class="s">price_min:</span><span class="nv"> </span><span class="s">0</span>
<span class="w">      </span><span class="s">}</span>
<span class="w">    </span><span class="s">})}&quot;</span>
</code></pre></div>

<h2 id="6">6. é€šé…ç¬¦æ‰¹é‡æ ¡éªŒ<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 é€šé…ç¬¦ <code>*</code> è¯­æ³•<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<p>ä½¿ç”¨ <code>*</code> é€šé…ç¬¦å¯ä»¥åŒ¹é…ä»»æ„å±‚çº§çš„æ•°æ®ï¼Œå®ç°æ‰¹é‡æ ¡éªŒã€‚</p>
<p><strong>è¯­æ³•</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>path.to.*.field
path.to.*.nested.*.field
</code></pre></div>

<h3 id="62">6.2 å•å±‚é€šé…ç¬¦<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<p><strong>åœºæ™¯</strong>ï¼šæ ¡éªŒæ‰€æœ‰äº§å“çš„ ID å’Œä»·æ ¼ã€‚</p>
<p><strong>å“åº”æ•°æ®</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;products&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">field_paths</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    é€šç”¨å­—æ®µæ£€æŸ¥å‡½æ•°</span>
<span class="sd">    æ”¯æŒé€šé…ç¬¦è·¯å¾„</span>

<span class="sd">    Args:</span>
<span class="sd">        data: å“åº”æ•°æ®</span>
<span class="sd">        *field_paths: å­—æ®µè·¯å¾„åˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦</span>
<span class="sd">            å¦‚: &quot;products.*.id&quot;, &quot;products.*.price&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">field_paths</span><span class="p">:</span>
        <span class="n">_check_field_path</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_check_field_path</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æ£€æŸ¥å•ä¸ªå­—æ®µè·¯å¾„&quot;&quot;&quot;</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">_recursive_check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parts</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_recursive_check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;é€’å½’æ£€æŸ¥å­—æ®µ&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">parts</span><span class="p">:</span>
        <span class="c1"># è·¯å¾„æ£€æŸ¥å®Œæ¯•ï¼Œç¡®ä¿æ•°æ®ä¸ä¸º None</span>
        <span class="k">assert</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Field value is None&quot;</span>
        <span class="k">return</span>

    <span class="n">part</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">remaining</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="n">part</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
        <span class="c1"># é€šé…ç¬¦ï¼šéå†åˆ—è¡¨æˆ–å­—å…¸</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">_recursive_check</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">remaining</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">_recursive_check</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">remaining</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># æ™®é€šå­—æ®µ</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">part</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span>
            <span class="n">_recursive_check</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">part</span><span class="p">],</span> <span class="n">remaining</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot access field &#39;</span><span class="si">{</span><span class="n">part</span><span class="si">}</span><span class="s2">&#39; on non-dict data&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># æ£€æŸ¥æ‰€æœ‰äº§å“çš„ id å’Œ price</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content, products.*.id, products.*.price)}</span>
</code></pre></div>

<h3 id="63">6.3 å¤šå±‚é€šé…ç¬¦<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<p><strong>åœºæ™¯</strong>ï¼šæ ¡éªŒæ‰€æœ‰äº§å“çš„æ‰€æœ‰ SKU çš„å­—æ®µã€‚</p>
<p><strong>å“åº”æ•°æ®</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;products&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EUR&quot;</span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># æ£€æŸ¥æ‰€æœ‰äº§å“çš„æ‰€æœ‰ SKU çš„å­—æ®µ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">products.*.id,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">products.*.sku.*.id,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">products.*.sku.*.amount,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">products.*.sku.*.currency</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>
</code></pre></div>

<h3 id="64">6.4 é€šé…ç¬¦ + é“¾å¼å–å€¼<a class="headerlink" href="#64" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># æ£€æŸ¥åµŒå¥—æ·±å±‚æ•°æ®</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">data.product.purchasePlan.*.sku.*.id,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">data.product.purchasePlan.*.sku.*.amount,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">data.product.purchasePlan.*.sku.*.origin_amount,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">data.product.purchasePlan.*.sku.*.currency,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">data.product.purchasePlan.*.sku.*.duration</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>
</code></pre></div>

<h2 id="7">7. æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 æ­£åˆ™è¡¨è¾¾å¼è¯­æ³• <code>~=</code><a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<p>ä½¿ç”¨ <code>~=</code> æ“ä½œç¬¦è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚</p>
<p><strong>è¯­æ³•</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>&#39;field_name ~= regex_pattern&#39;
</code></pre></div>

<h3 id="72-url">7.2 ä½¿ç”¨åœºæ™¯ï¼šURL æ ¼å¼æ ¡éªŒ<a class="headerlink" href="#72-url" title="Permanent link">&para;</a></h3>
<p><strong>debugtalk.py</strong>ï¼ˆæ‰©å±• check å‡½æ•°ï¼‰ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">rules</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    é€šç”¨æ£€æŸ¥å‡½æ•°</span>
<span class="sd">    æ”¯æŒï¼š</span>
<span class="sd">    - é€šé…ç¬¦è·¯å¾„: &quot;products.*.id&quot;</span>
<span class="sd">    - æ­£åˆ™è¡¨è¾¾å¼: &quot;_url ~= ^https?://.*&quot;</span>
<span class="sd">    - åŒ…å«æ ¡éªŒ: &quot;status =* [active, pending]&quot;</span>
<span class="sd">    - ç±»å‹æ ¡éªŒ: &quot;user @= dict&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39; ~= &#39;</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">:</span>
            <span class="c1"># æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ</span>
            <span class="n">field</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; ~= &#39;</span><span class="p">)</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">_check_regex</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># æ™®é€šå­—æ®µè·¯å¾„æ ¡éªŒ</span>
            <span class="n">_check_field_path</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_check_regex</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ&quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">_get_field_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span> \
        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; does not match pattern &#39;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># URL æ ¼å¼æ ¡éªŒ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;_url ~= ^https?://[^\s/$.?#].[^\s]*$&#39;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>

<span class="w">  </span><span class="c1"># é‚®ç®±æ ¼å¼æ ¡éªŒ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;user.email ~= ^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#39;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>

<span class="w">  </span><span class="c1"># ç”µè¯å·ç æ ¼å¼æ ¡éªŒ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;user.phone ~= ^1[3-9]\d{9}$&#39;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>
</code></pre></div>

<h2 id="8">8. ç±»å‹æ ¡éªŒ<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ç±»å‹æ ¡éªŒè¯­æ³• <code>@=</code><a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<p>ä½¿ç”¨ <code>@=</code> æ“ä½œç¬¦è¿›è¡Œç±»å‹æ ¡éªŒã€‚</p>
<p><strong>è¯­æ³•</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>&#39;field_name @= type_name&#39;
</code></pre></div>

<p><strong>æ”¯æŒçš„ç±»å‹</strong>ï¼š
- <code>dict</code> - å­—å…¸ç±»å‹
- <code>list</code> - åˆ—è¡¨ç±»å‹
- <code>str</code> - å­—ç¬¦ä¸²ç±»å‹
- <code>int</code> - æ•´æ•°ç±»å‹
- <code>float</code> - æµ®ç‚¹æ•°ç±»å‹
- <code>bool</code> - å¸ƒå°”ç±»å‹</p>
<h3 id="82">8.2 ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®ç»“æ„æ ¡éªŒ<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<p><strong>debugtalk.py</strong>ï¼ˆç»§ç»­æ‰©å±• check å‡½æ•°ï¼‰ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">rules</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;é€šç”¨æ£€æŸ¥å‡½æ•°&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39; ~= &#39;</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">:</span>
                <span class="c1"># æ­£åˆ™è¡¨è¾¾å¼</span>
                <span class="n">field</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; ~= &#39;</span><span class="p">)</span>
                <span class="n">_check_regex</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">pattern</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">elif</span> <span class="s1">&#39; =* &#39;</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">:</span>
                <span class="c1"># åŒ…å«æ ¡éªŒ</span>
                <span class="n">field</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; =* &#39;</span><span class="p">)</span>
                <span class="n">_check_contains</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">values</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">elif</span> <span class="s1">&#39; @= &#39;</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">:</span>
                <span class="c1"># ç±»å‹æ ¡éªŒ</span>
                <span class="n">field</span><span class="p">,</span> <span class="n">type_name</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; @= &#39;</span><span class="p">)</span>
                <span class="n">_check_type</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">type_name</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># å­—æ®µè·¯å¾„</span>
                <span class="n">_check_field_path</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_check_field_path</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_check_type</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">type_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ç±»å‹æ ¡éªŒ&quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">_get_field_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

    <span class="n">type_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;dict&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="s1">&#39;list&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
        <span class="s1">&#39;str&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;bool&#39;</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">}</span>

    <span class="n">expected_type</span> <span class="o">=</span> <span class="n">type_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">type_name</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">expected_type</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown type: </span><span class="si">{</span><span class="n">type_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">),</span> \
        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; type is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="n">type_name</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ç±»å‹æ ¡éªŒ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;user @= dict&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;user.id @= int&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;user.name @= str&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;user.is_active @= bool&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;products @= list&#39;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>
</code></pre></div>

<h3 id="83">8.3 åŒ…å«æ ¡éªŒè¯­æ³• <code>=*</code><a class="headerlink" href="#83" title="Permanent link">&para;</a></h3>
<p>ä½¿ç”¨ <code>=*</code> æ“ä½œç¬¦æ£€æŸ¥å€¼æ˜¯å¦åœ¨æŒ‡å®šèŒƒå›´å†…ã€‚</p>
<p><strong>è¯­æ³•</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>&#39;field_name =* [value1, value2, value3]&#39;
</code></pre></div>

<p><strong>debugtalk.py</strong>ï¼ˆcheck å‡½æ•°å·²åŒ…å«ï¼‰ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_check_contains</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">values_str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;åŒ…å«æ ¡éªŒ&quot;&quot;&quot;</span>
    <span class="c1"># è§£æå€¼åˆ—è¡¨: &quot;[USD, CNY, EUR]&quot; -&gt; [&quot;USD&quot;, &quot;CNY&quot;, &quot;EUR&quot;]</span>
    <span class="n">values_str</span> <span class="o">=</span> <span class="n">values_str</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span>
    <span class="n">expected_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">_get_field_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">expected_values</span><span class="p">,</span> \
        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; not in </span><span class="si">{</span><span class="n">expected_values</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># è´§å¸ç±»å‹æ ¡éªŒ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;default_currency =* [USD, CNY, EUR]&#39;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>

<span class="w">  </span><span class="c1"># çŠ¶æ€æ ¡éªŒ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;order.status =* [pending, processing, completed, cancelled]&#39;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>
</code></pre></div>

<h2 id="9">9. ç»¼åˆå®æˆ˜æ¡ˆä¾‹<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="1-api">æ¡ˆä¾‹ 1ï¼šç”µå•† API å®Œæ•´æ ¡éªŒ<a class="headerlink" href="#1-api" title="Permanent link">&para;</a></h3>
<p><strong>å“åº”æ•°æ®</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://api.example.com/products&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;default_currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;default_sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DEFAULT_001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">99.99</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;product&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Product Name&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;purchasePlan&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;plan_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PLAN_001&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sku&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SKU_001&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;origin_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SKU_002&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;origin_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">240</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ä¸€æ¬¡æ€§æ ¡éªŒæ‰€æœ‰å­—æ®µ</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;_url ~= ^https?://[^\s/$.?#].[^\s]*$&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;default_currency =* [USD, CNY, EUR]&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;default_sku @= dict&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;product @= dict&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&#39;product.purchasePlan @= list&#39;,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">product.purchasePlan.*.sku.*.id,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">product.purchasePlan.*.sku.*.amount,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">product.purchasePlan.*.sku.*.origin_amount,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">product.purchasePlan.*.sku.*.currency,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">product.purchasePlan.*.sku.*.duration</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>
</code></pre></div>

<h3 id="2_1">æ¡ˆä¾‹ 2ï¼šç”¨æˆ·ä¿¡æ¯å¤æ‚æ ¡éªŒ<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h3>
<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_user_complete</span><span class="p">(</span><span class="n">user_data</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ç”¨æˆ·ä¿¡æ¯å®Œæ•´æ ¡éªŒ</span>

<span class="sd">    Args:</span>
<span class="sd">        user_data: ç”¨æˆ·æ•°æ®</span>
<span class="sd">        rules: æ ¡éªŒè§„åˆ™ {</span>
<span class="sd">            &quot;required_fields&quot;: [&quot;id&quot;, &quot;name&quot;, &quot;email&quot;],</span>
<span class="sd">            &quot;email_pattern&quot;: &quot;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&quot;,</span>
<span class="sd">            &quot;name_min_length&quot;: 2,</span>
<span class="sd">            &quot;name_max_length&quot;: 50,</span>
<span class="sd">            &quot;check_permissions&quot;: true,</span>
<span class="sd">            &quot;required_permissions&quot;: [&quot;read&quot;, &quot;write&quot;]</span>
<span class="sd">        }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

    <span class="c1"># æ£€æŸ¥å¿…å¡«å­—æ®µ</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;required_fields&quot;</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="k">assert</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">user_data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Missing required field: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="n">user_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; is None&quot;</span>

    <span class="c1"># æ£€æŸ¥é‚®ç®±æ ¼å¼</span>
    <span class="k">if</span> <span class="s2">&quot;email_pattern&quot;</span> <span class="ow">in</span> <span class="n">rules</span> <span class="ow">and</span> <span class="s2">&quot;email&quot;</span> <span class="ow">in</span> <span class="n">user_data</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">rules</span><span class="p">[</span><span class="s2">&quot;email_pattern&quot;</span><span class="p">]</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">user_data</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">email</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Invalid email format: </span><span class="si">{</span><span class="n">email</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># æ£€æŸ¥åç§°é•¿åº¦</span>
    <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">user_data</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">user_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">min_len</span> <span class="o">=</span> <span class="n">rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name_min_length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">max_len</span> <span class="o">=</span> <span class="n">rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name_max_length&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">min_len</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_len</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;Name length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2"> not in range [</span><span class="si">{</span><span class="n">min_len</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">max_len</span><span class="si">}</span><span class="s2">]&quot;</span>

    <span class="c1"># æ£€æŸ¥æƒé™</span>
    <span class="k">if</span> <span class="n">rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;check_permissions&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">required_perms</span> <span class="o">=</span> <span class="n">rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;required_permissions&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">user_perms</span> <span class="o">=</span> <span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;permissions&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">required_perms</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">user_perms</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Missing permission: </span><span class="si">{</span><span class="n">perm</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;${validate_user_complete(content.user,</span><span class="nv"> </span><span class="s">{</span>
<span class="w">      </span><span class="s">required_fields:</span><span class="nv"> </span><span class="s">[id,</span><span class="nv"> </span><span class="s">name,</span><span class="nv"> </span><span class="s">email,</span><span class="nv"> </span><span class="s">phone],</span>
<span class="w">      </span><span class="s">email_pattern:</span><span class="nv"> </span><span class="s">&#39;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+</span><span class="err">\</span><span class="s">.[a-zA-Z]{2,}$&#39;,</span>
<span class="w">      </span><span class="s">name_min_length:</span><span class="nv"> </span><span class="s">2,</span>
<span class="w">      </span><span class="s">name_max_length:</span><span class="nv"> </span><span class="s">50,</span>
<span class="w">      </span><span class="s">check_permissions:</span><span class="nv"> </span><span class="s">true,</span>
<span class="w">      </span><span class="s">required_permissions:</span><span class="nv"> </span><span class="s">[read,</span><span class="nv"> </span><span class="s">write,</span><span class="nv"> </span><span class="s">delete]</span>
<span class="w">    </span><span class="s">})}&quot;</span>
</code></pre></div>

<h3 id="3_1">æ¡ˆä¾‹ 3ï¼šå¤šç¯å¢ƒé…ç½®ç­¾å<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h3>
<p><strong>debugtalk.py</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_signature</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ç”Ÿæˆè¯·æ±‚ç­¾å</span>

<span class="sd">    Args:</span>
<span class="sd">        params: ç­¾åå‚æ•° {</span>
<span class="sd">            &quot;method&quot;: &quot;POST&quot;,</span>
<span class="sd">            &quot;url&quot;: &quot;/api/users&quot;,</span>
<span class="sd">            &quot;timestamp&quot;: 1234567890,</span>
<span class="sd">            &quot;nonce&quot;: &quot;random_string&quot;,</span>
<span class="sd">            &quot;body&quot;: {...},</span>
<span class="sd">            &quot;secret_key&quot;: &quot;xxx&quot;</span>
<span class="sd">        }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># æŒ‰keyæ’åº</span>
    <span class="n">sorted_params</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span>
        <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
        <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;secret_key&#39;</span>
    <span class="p">])</span>

    <span class="c1"># æ‹¼æ¥å­—ç¬¦ä¸²</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="s1">&#39;&amp;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sorted_params</span><span class="p">])</span>

    <span class="c1"># ç”Ÿæˆç­¾å</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;secret_key&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">sign_str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">sign</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_timestamp</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;è·å–å½“å‰æ—¶é—´æˆ³&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_nonce</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ç”Ÿæˆéšæœºå­—ç¬¦ä¸²&quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">16</span><span class="p">))</span>
</code></pre></div>

<p><strong>æµ‹è¯•ç”¨ä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">variables</span><span class="p">:</span>
<span class="w">  </span><span class="nt">secret_key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;MySecretKey123&quot;</span>
<span class="w">  </span><span class="nt">request_method</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;POST&quot;</span>
<span class="w">  </span><span class="nt">request_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api/users&quot;</span>

<span class="nt">teststeps</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">åˆ›å»ºç”¨æˆ·ï¼ˆå¸¦ç­¾åï¼‰</span>
<span class="w">  </span><span class="nt">request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$base_url$request_url</span>
<span class="w">    </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POST</span>
<span class="w">    </span><span class="nt">headers</span><span class="p">:</span>
<span class="w">      </span><span class="nt">X-Timestamp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_timestamp()}</span>
<span class="w">      </span><span class="nt">X-Nonce</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_nonce()}</span>
<span class="w">      </span><span class="nt">X-Signature</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${generate_signature({</span>
<span class="w">        </span><span class="s">method:</span><span class="nv"> </span><span class="s">$request_method,</span>
<span class="w">        </span><span class="s">url:</span><span class="nv"> </span><span class="s">$request_url,</span>
<span class="w">        </span><span class="s">timestamp:</span><span class="nv"> </span><span class="s">${get_timestamp()},</span>
<span class="w">        </span><span class="s">nonce:</span><span class="nv"> </span><span class="s">${get_nonce()},</span>
<span class="w">        </span><span class="s">body:</span><span class="nv"> </span><span class="s">{name:</span><span class="nv"> </span><span class="s">&#39;Alice&#39;,</span><span class="nv"> </span><span class="s">email:</span><span class="nv"> </span><span class="s">&#39;alice@example.com&#39;},</span>
<span class="w">        </span><span class="s">secret_key:</span><span class="nv"> </span><span class="s">$secret_key</span>
<span class="w">      </span><span class="s">})}&quot;</span>
<span class="w">    </span><span class="nt">json</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span>
<span class="w">      </span><span class="nt">email</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;alice@example.com&quot;</span>
</code></pre></div>

<h2 id="10">10. æœ€ä½³å®è·µ<a class="headerlink" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 å‚æ•°å‘½åè§„èŒƒ<a class="headerlink" href="#101" title="Permanent link">&para;</a></h3>
<p><strong>æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âœ… æ¸…æ™°çš„å‚æ•°å</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_user_data</span><span class="p">(</span><span class="n">user_data</span><span class="p">,</span> <span class="n">validation_rules</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_nested_fields</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">field_config</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>

<p><strong>ä¸æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âŒ æ¨¡ç³Šçš„å‚æ•°å</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>

<h3 id="102">10.2 å‡½æ•°èŒè´£å•ä¸€<a class="headerlink" href="#102" title="Permanent link">&para;</a></h3>
<p><strong>æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âœ… èŒè´£å•ä¸€</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_email_format</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;åªéªŒè¯é‚®ç®±æ ¼å¼&quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#39;</span>
    <span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">email</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Invalid email: </span><span class="si">{</span><span class="n">email</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate_required_fields</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;åªéªŒè¯å¿…å¡«å­—æ®µ&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Missing field: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<p><strong>ä¸æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âŒ èŒè´£æ··ä¹±</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_everything</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;åšå¤ªå¤šäº‹æƒ…&quot;&quot;&quot;</span>
    <span class="c1"># éªŒè¯æ ¼å¼</span>
    <span class="c1"># éªŒè¯å­—æ®µ</span>
    <span class="c1"># éªŒè¯ç±»å‹</span>
    <span class="c1"># éªŒè¯ä¸šåŠ¡é€»è¾‘</span>
    <span class="c1"># ...</span>
    <span class="k">pass</span>
</code></pre></div>

<h3 id="103">10.3 æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯<a class="headerlink" href="#103" title="Permanent link">&para;</a></h3>
<p><strong>æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âœ… æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_price</span><span class="p">(</span><span class="n">price</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)),</span> \
        <span class="sa">f</span><span class="s2">&quot;Price must be number, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="n">price</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> \
        <span class="sa">f</span><span class="s2">&quot;Price must be non-negative, got </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="n">price</span> <span class="o">&lt;=</span> <span class="mi">1000000</span><span class="p">,</span> \
        <span class="sa">f</span><span class="s2">&quot;Price must be less than 1000000, got </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<p><strong>ä¸æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âŒ æ¨¡ç³Šçš„é”™è¯¯ä¿¡æ¯</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_price</span><span class="p">(</span><span class="n">price</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)),</span> <span class="s2">&quot;Invalid type&quot;</span>
    <span class="k">assert</span> <span class="n">price</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Invalid value&quot;</span>
    <span class="k">assert</span> <span class="n">price</span> <span class="o">&lt;=</span> <span class="mi">1000000</span><span class="p">,</span> <span class="s2">&quot;Too large&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<h3 id="104">10.4 åˆç†ä½¿ç”¨é€šé…ç¬¦<a class="headerlink" href="#104" title="Permanent link">&para;</a></h3>
<p><strong>æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âœ… é€šé…ç¬¦é…åˆå…·ä½“å­—æ®µ</span>
<span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># å…ˆæ£€æŸ¥åŸºæœ¬ç»“æ„</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assert isinstance(content.products, list)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assert len(content.products) &gt; 0</span>

<span class="w">  </span><span class="c1"># å†ä½¿ç”¨é€šé…ç¬¦æ‰¹é‡æ£€æŸ¥</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">products.*.id,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">products.*.price</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">)}</span>
</code></pre></div>

<p><strong>ä¸æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># âŒ è¿‡åº¦ä¾èµ–é€šé…ç¬¦</span>
<span class="nt">script</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ç›´æ¥ä½¿ç”¨é€šé…ç¬¦ï¼Œé”™è¯¯ä¿¡æ¯ä¸æ˜ç¡®</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${check(content, products.*.*.*)}</span>
</code></pre></div>

<h3 id="105">10.5 æ–‡æ¡£æ³¨é‡Š<a class="headerlink" href="#105" title="Permanent link">&para;</a></h3>
<p><strong>æ¨è</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_nested_list_fields</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    æ£€æŸ¥åµŒå¥—åˆ—è¡¨ä¸­çš„å­—æ®µ</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict): å“åº”æ•°æ®</span>
<span class="sd">        config (dict): é…ç½®å¯¹è±¡</span>
<span class="sd">            - list_path (str): å¤–å±‚åˆ—è¡¨è·¯å¾„</span>
<span class="sd">            - nested_field (str): å†…å±‚åˆ—è¡¨å­—æ®µå</span>
<span class="sd">            - check_fields (list): éœ€è¦æ£€æŸ¥çš„å­—æ®µåˆ—è¡¨</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: æ ¡éªŒæ˜¯å¦é€šè¿‡</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: å½“æ ¡éªŒå¤±è´¥æ—¶</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; check_nested_list_fields(response, {</span>
<span class="sd">        ...     &quot;list_path&quot;: &quot;products&quot;,</span>
<span class="sd">        ...     &quot;nested_field&quot;: &quot;sku&quot;,</span>
<span class="sd">        ...     &quot;check_fields&quot;: [&quot;id&quot;, &quot;price&quot;]</span>
<span class="sd">        ... })</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div>

<h3 id="106">10.6 æ€§èƒ½è€ƒè™‘<a class="headerlink" href="#106" title="Permanent link">&para;</a></h3>
<p><strong>é€šé…ç¬¦æ‰¹é‡æ ¡éªŒ</strong>ï¼š
- âœ… é€‚åˆï¼šæ•°æ®é‡ &lt; 1000 æ¡
- âš ï¸ æ³¨æ„ï¼šæ•°æ®é‡ 1000-10000 æ¡
- âŒ ä¸æ¨èï¼šæ•°æ®é‡ &gt; 10000 æ¡ï¼ˆè€ƒè™‘æŠ½æ ·æ ¡éªŒï¼‰</p>
<p><strong>æŠ½æ ·æ ¡éªŒç¤ºä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_large_list</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field_path</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    å¤§åˆ—è¡¨æŠ½æ ·æ ¡éªŒ</span>

<span class="sd">    Args:</span>
<span class="sd">        data: æ•°æ®</span>
<span class="sd">        field_path: å­—æ®µè·¯å¾„</span>
<span class="sd">        sample_size: æŠ½æ ·æ•°é‡</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

    <span class="n">items</span> <span class="o">=</span> <span class="n">_get_field_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">field_path</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;Field must be a list&quot;</span>

    <span class="c1"># å¦‚æœæ•°æ®é‡å°ï¼Œå…¨é‡æ£€æŸ¥</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">sample_size</span><span class="p">:</span>
        <span class="n">check_items</span> <span class="o">=</span> <span class="n">items</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># å¤§æ•°æ®é‡ï¼ŒéšæœºæŠ½æ ·</span>
        <span class="n">check_items</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>

    <span class="c1"># æ ¡éªŒæŠ½æ ·æ•°æ®</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">check_items</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="c1"># å…¶ä»–æ ¡éªŒé€»è¾‘...</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<h2 id="_5">ğŸ“ æ€»ç»“<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>ApiMeter çš„è‡ªå®šä¹‰å‡½æ•°é«˜çº§å‚æ•°æ”¯æŒè®© API æµ‹è¯•å˜å¾—æ›´åŠ çµæ´»å’Œå¼ºå¤§ï¼š</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>ä½¿ç”¨åœºæ™¯</th>
<th>ä¼˜åŠ¿</th>
</tr>
</thead>
<tbody>
<tr>
<td>åˆ—è¡¨å‚æ•°</td>
<td>ç­¾åç”Ÿæˆã€æ‰¹é‡æ ¡éªŒ</td>
<td>ç®€åŒ–å‚æ•°ä¼ é€’</td>
</tr>
<tr>
<td>å­—å…¸å‚æ•°</td>
<td>å¤æ‚é…ç½®ä¼ é€’</td>
<td>è¯­ä¹‰æ¸…æ™°</td>
</tr>
<tr>
<td>åµŒå¥—å¯¹è±¡</td>
<td>å¤šå±‚æ•°æ®æ ¡éªŒ</td>
<td>åŠŸèƒ½å¼ºå¤§</td>
</tr>
<tr>
<td>é€šé…ç¬¦ <code>*</code></td>
<td>æ‰¹é‡å­—æ®µæ ¡éªŒ</td>
<td>é«˜æ•ˆä¾¿æ·</td>
</tr>
<tr>
<td>æ­£åˆ™ <code>~=</code></td>
<td>æ ¼å¼æ ¡éªŒ</td>
<td>çµæ´»åŒ¹é…</td>
</tr>
<tr>
<td>ç±»å‹ <code>@=</code></td>
<td>æ•°æ®ç»“æ„æ ¡éªŒ</td>
<td>ç±»å‹å®‰å…¨</td>
</tr>
<tr>
<td>åŒ…å« <code>=*</code></td>
<td>æšä¸¾å€¼æ ¡éªŒ</td>
<td>èŒƒå›´æ£€æŸ¥</td>
</tr>
</tbody>
</table>
<p><strong>ä¸‹ä¸€æ­¥å­¦ä¹ </strong>ï¼š
- <a href="../global-variables/">å…¨å±€å˜é‡å®Œæ•´æŒ‡å—</a>
- <a href="../../examples/advanced-examples/">é«˜çº§ç”¨æ³•ç¤ºä¾‹</a>
- <a href="../../prepare/script/">è‡ªå®šä¹‰è„šæœ¬æ ¡éªŒ</a></p>
<hr />
<p><strong>æœ‰é—®é¢˜ï¼Ÿ</strong> æŸ¥çœ‹ <a href="../../FAQ/">FAQ</a> æˆ– <a href="https://git.umlife.net/utils/apimeter/issues">æäº¤ Issue</a></p>
                
                  
                
              

<!-- AIåŠ©æ‰‹æµ®çª—è„šæœ¬ -->
<script
async
defer
src="https://view.umlife.net/chat/api/embed?protocol=https&host=view.umlife.net&token=1d8f7ca0d76e223f">
</script>


              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 - 2025 debugtalk
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://git.umlife.net/utils/apimeter" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://git.umlife.net/utils/apimeter" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a353778b.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.6.1",url:{base:"../.."}})</script>
      
        <script src="../../js/slardar.js"></script>
      
    
  </body>
</html>